# Microsoft-malware-classification
Classification of malware samples open sourced by Microsoft using tree based classifiers
## Part 1 : Feature extraction
1. Unigrams - using scikit-learn CountVectorizer
2. Bigrams - Script for bigrams extraction - bi_grams.py. Extraction done in 7 batches, each time manully changing the script content
3. Size of byte files
4. Size of asm files - ASM size.ipynb. 5 parallel jobs deployed, one for each folder (divided the asm files into 5 folders)
5. Opcodes from asm files - opcodes.py - search for pre defined opcodes (ones necessary for classification as indicated by kaggle blogs) on 5 folders of asm files
Concate bigrams.ipynb concatenates bigrams(sparse) with other dense features. Since the size becomes too large, they have to be concatenated in batches and Integrate bigrams.ipynb does final vertical stacking to generate a 10868 * 65942 sparse matrix
## Part 2 : Machine learning models
1. Random Forest classifier : it gives a log loss of 0.032 when all data is used. Feature importance is taken from this and used to reduce features to train GBDT
2. First 3000 features ordered by their importance as decided by RF are used to train GBDT which gives log loss of 0.025. This can be improved by using 6000 features given more memory.
